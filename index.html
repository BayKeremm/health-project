<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Sleep Schedule Tracker in CouchDB</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="app.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    .centered-button {
      display: flex;
      justify-content: center;
    }

    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h1, h2 {
      text-align: center;
      color: #333;
    }

    label {
      font-weight: bold;
    }

    input[type="text"],
    input[type="time"],
    input[type="date"],
    select {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      margin: 8px 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    canvas {
      display: block;
      margin: 0 auto;
      width: 100%;
      max-width: 600px;
      height: auto;
    }

    #export-button {
      display: block;
      margin: 20px auto;
    }
    
    /* Styles for the modal */
    .modal {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; /* Enable scroll if needed */
      background-color: rgb(0,0,0); /* Fallback color */
      background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto; /* 15% from the top and centered */
      padding: 20px;
      border: 1px solid #888;
      width: 80%; /* Could be more or less, depending on screen size */
      border-radius: 8px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    .advice {
      background-color: #e7f3fe;
      border-left: 6px solid #2196F3;
      margin: 20px 0;
      padding: 20px;
      font-size: 1.2em;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Sleep Schedule Tracker</h1>

    <h2>Create a new user</h2>

    <div id="user-div">
      <label for="user-input">User's name:</label>
      <input type="text" id="user-input">
      <button id="user-button">Create</button>
    </div>

    <div>
      <label for="user-select">Choose a user:</label>
      <select name="user-select" id="user-select">
        <option value="">Select a user</option> 
      </select>
    </div>

    <div id="sleep-schedule-div" style="visibility:hidden">
      <label for="sleep-time-input">Record sleep time:</label>
      <input type="time" id="sleep-time-input">
      <label for="wake-up-time-input">Wake up time:</label>
      <input type="time" id="wake-up-time-input">
      <label for="bedtime-date">Bedtime Date</label>
      <input type="date" placeholder="yyyy-mm-dd" id="bedtime-date">
      <button id="sleep-schedule-button">Add</button>
      <p id="current-goal"></p>
      <!-- Button to open the modal for setting sleep goal -->
      <div class="centered-button">
        <button id="set-goal-button">Set Sleep Goal</button>
      </div>

      <!-- Modal for setting sleep goal -->
      <div id="goal-modal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>Set Sleep Goal</h2>
          <label for="goal-start">Sleep Goal Start:</label>
          <input type="time" id="goal-start">
          <label for="goal-end">Sleep Goal End:</label>
          <input type="time" id="goal-end">
          <button id="save-goal-button">Save Goal</button>
        </div>
      </div>
      <button id="export-button">Export Sleep Data as JSON</button>
      <div style="position: relative; height:40vh;">
        <canvas id="sleep-schedule"></canvas>
      </div>
      <div class="centered-button">
          <button style="background-color: #f44336" id="set-delete-data-button" onclick="openDeleteDataModal()">Delete Data</button>
      </div>
      <!-- Modal to view and delete existing data -->
      <div id="delete-data-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Select Data to be deleted</h2>
            <div id="checkbox-div"></div>
            <button style="background-color: #f44336" id="delete-data-confirm" onclick="deleteData()">Delete</button>
        </div>
      </div>

      <div class="advice" id="advice">
        <p><strong>Did you know?</strong> <span id="advice-text"></span></p>
      </div>
    </div>
  </div>
  
  <script>
    // Get the modal
    var modal = document.getElementById('goal-modal');

    // Get the button that opens the modal
    var btn = document.getElementById('set-goal-button');

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName('close')[0];

    // When the user clicks on the button, open the modal
    btn.onclick = function() {
      modal.style.display = 'block';
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = 'none';
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = 'none';
      }
    }

    // Sleep advice data
    const adviceList = [
      "Getting enough sleep helps improve memory and cognitive function.",
      "Adults should aim for 7-9 hours of sleep per night.",
      "Consistent sleep helps regulate mood and reduce stress.",
      "Poor sleep can increase the risk of cardiovascular disease.",
      "Adequate sleep boosts the immune system and helps fight off infections.",
      "Children and teenagers need more sleep than adults for healthy growth and development.",
      "Good sleep hygiene, like a regular sleep schedule, improves sleep quality.",
      "Lack of sleep can impair motor skills and increase the risk of accidents.",
      "Deep sleep is crucial for physical restoration and muscle repair.",
      "Quality sleep can enhance problem-solving skills and creativity."
    ];

    // Display a random piece of advice
    function displayRandomAdvice() {
      const randomIndex = Math.floor(Math.random() * adviceList.length);
      document.getElementById('advice-text').innerText = adviceList[randomIndex];
    }

    // Call the function to display a random piece of advice when the page loads
    window.onload = displayRandomAdvice;
  </script>
<script>
    var toDeleteModal = document.getElementById('delete-data-modal');
    var spanDelete = document.getElementsByClassName('close')[1];
    spanDelete.onclick = () => {
        toDeleteModal.style.display = 'none';
        var div = document.getElementById("checkbox-div");
        div.innerHTML = '';
    }
    window.onclick = (event) => {
        if (event.target == toDeleteModal) {
            toDeleteModal.style.display = 'none';
            var div = document.getElementById("checkbox-div");
            div.innerHTML = '';
        }
    }
</script>
</body>
</html>
